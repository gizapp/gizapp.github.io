<html style="background:#eff">
<head>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Recursive:wght@300..800&display=swap');
  body {
    padding:2em 0;
  }
  * {
    font-family:Recursive, sans-serif;
    color:#05a;
  }
  h1 {
    font-size:5em;
    margin:0;
    font-weight:300;
    color:#0ae;
  }
  hr {
    margin:2em;
    border-color:#0ae;
    border-bottom:0;
  }
  input {
    padding:0.5em;
  }
  .cmdEntry {
    width:100%;
    position:absolute;
    transition:top 0.5s, width 0.5s;
    display:flex;
    top:0em;
    overflow:hidden;
  }
  svg {
    fill:none;
    stroke:#06f;
    stroke-linecap:round;
    stroke-linejoin:round;
  }
  #cmdPanel {
    width:20em;
    position:relative;
    height:5em;
  }
  button, input {
    border: 0.1em solid #0ae;
    border-radius:0.5em;
  }
  button {
    background:#ddf0ff;
  }
  .left {
    border-radius:0.5em 0 0 0.5em;
  }
  .right {
    border-radius:0 0.5em 0.5em 0;
    border-left:0;
  }
</style>
</head>
<body>
<center>
  <svg viewBox="-90 -30 180 60"
    style="stroke-width:2px;height:8em;stroke:#0ae">
    <path d="M58-23H92M74-23V25M32-12C32-12 32-12 32-12M32-12C32-12 44-25 44-25M44-25C44-25 44-25 44-25M44-25C44-25 44-25 44-1M44-1C44 23 44 23 44 23M55 23C55 23 55 23 55 23M55 23C55 23 44 23 44 23M44 23C44 23 32 23 32 23M-11 0V0M-11 0C-11-16-3-24 5-24M5-24C12-24 15-21 15-21M15-21V-21M-11 0V0M4-3C11-3 18 1 18 10M18 10C18 18 12 24 4 24M4 24C-4 24-11 18-11 0M-43-12C-43-12-43-12-43-12M-43-12C-43-12-30-25-30-25M-30-25C-30-25-30-25-30-25M-30-25C-30-25-30-25-30-1M-30-1C-30 23-30 23-30 23M-19 23C-19 23-19 23-19 23M-19 23C-19 23-31 23-31 23M-31 23C-31 23-43 23-43 23M-80-24V24C-66 24-54 22-54 0-54-22-64-24-80-24Z"></path>
  </svg>
</center>
<center>
  <h1>animator</h1>
</center>
<hr/>
<center>
  <svg viewBox="-18 -32 36 64"
    style="stroke-width:4px;height:12em">
    <path><animate fill="freeze" attributeName="d"></animate></path>
  </svg>
  <svg viewBox="-18 -32 36 64"
    style="stroke-width:4px;height:12em">
    <path><animate fill="freeze" attributeName="d"></animate></path>
  </svg>
  <svg viewBox="-18 -32 36 64"
    style="stroke-width:4px;height:12em">
    <path><animate fill="freeze" attributeName="d"></animate></path>
  </svg>
  <svg viewBox="-18 -32 36 64"
    style="stroke-width:4px;height:12em">
    <path><animate fill="freeze" attributeName="d"></animate></path>
  </svg>
  <svg viewBox="-18 -32 36 64"
    style="stroke-width:4px;height:12em">
    <path><animate fill="freeze" attributeName="d"></animate></path>
  </svg>
</center>
<center>
  <div id="cmdPanel">
    <div class="cmdEntry">
      <button class="left" style="height:100%;width:3em">▼</button><input maxlength="5" style="height:100%;width:100%" placeholder="Enter number to animate"/>
    </div>
    <div class="cmdEntry">
      <button class="left" style="height:100%;width:3em">▼</button><input class="right" maxlength="2" style="height:100%;width:calc(100% - 3em)" placeholder="Enter digit to animate"/>
    </div>
    <div class="cmdEntry">
      <button class="left" style="height:100%;width:3em">▼</button><button class="right" style="height:100%;width:calc(100% - 3em)">Animate</button>
    </div>
  </div>
</center>
<script>
  const entryHeight = 2
  const spacing = 0.5
  const minimizedWidth = 5
  const cmdPanel = document.getElementById('cmdPanel')
  mainPile = [...cmdPanel.children]
  const maxZ = mainPile.length
  for (const entry of mainPile) {
    entry.style.height = entryHeight + 'em'
    entry.navButton = entry.children[0]
    entry.formFields = [...entry.children].slice(1)
    entry.style.zIndex = maxZ
  }
  const makeDiscardButton = btn => {
    btn.innerText = '▼'
    btn.onclick = discardUI
  }
  makeDiscardButton(mainPile.at(-1).navButton)
  mainPile[0].removeChild(mainPile[0].navButton)
  mainPile[0].style.width = "100%"
  delete mainPile[0].navButton
  discardPile = []
  let ondiscardui = null
  function discardUI() {
    if (mainPile.length > 1) {
      const movedEntry = mainPile.pop()
      if (ondiscardui)
        ondiscardui(movedEntry)
      discardPile.push(movedEntry)
      movedEntry.style.top = entryHeight + spacing + 'em'
      movedEntry.navButton.onclick = returnUI
      movedEntry.navButton.innerText = '▲'
      movedEntry.style.width = minimizedWidth + 'em'
      if (movedEntry.ondiscard)
        movedEntry.ondiscard()
      for (const elem of movedEntry.formFields)
        elem.setAttribute('disabled', 'disabled')
      const zIndex = -mainPile.length + maxZ
      movedEntry.ontransitionend = function (e) {
        this.style.zIndex = zIndex
        this.ontransitionend = null
        ondiscardui = null
      }
      if (mainPile.at(-1).navButton)
        makeDiscardButton(mainPile.at(-1).navButton)
      ondiscardui = function (entry) {
        if (movedEntry.ontransitionend)
          movedEntry.ontransitionend()
        ondiscardui = null
      }
    }
  }
  function returnUI() {
    const movedEntry = discardPile.pop()
    movedEntry.style.zIndex = maxZ
    makeDiscardButton(movedEntry.navButton)
    movedEntry.ontransitionend = null
    movedEntry.style.width = null
    movedEntry.style.top = 0 + 'em'
    for (const elem of movedEntry.formFields)
      elem.removeAttribute('disabled')
    if (mainPile.at(-1).navButton)
      mainPile.at(-1).navButton.onclick = null
    mainPile.push(movedEntry)
  }

  const digits = ['M-15 0c0 0 0 0 0 0M-15 0C-15-16-8-24 0-24M0-24C8-24 15-18 15 0m0 0c0 0 0 0 0 0M-15 0c0 0 0 0 0 0M15 0c0 0 0 0 0 0M15 0C15 18 8 24 0 24M0 24C-8 24-15 18-15 0','M-12-12c0 0 0 0 0 0M-12-12C-12-12 1-25 1-25M1-25c0 0 0 0 0 0M1-25C1-25 1 23 1 23M-12 23c0 0 0 0 0 0M12 23c0 0 0 0 0 0M12 23C12 23 0 23 0 23M0 23C0 23-12 23-12 23','M-12-12c0 0 0 0 0 0M-12-12C-12-18-8-24 0-24M0-24C8-24 12-20 12-11M12-11C12-2 0 5 0 5M0 5C0 5-12 12-12 23M13 23c0 0 0 0 0 0M13 23C13 23 1 23 1 23M1 23C1 23-12 23-12 23','M-11-17c0 0 0 0 0 0M-11-17C-11-17-8-24 0-24M0-24C8-24 12-20 12-12M12-12C12-6 8-1-2-1M-12 17c0 0 0 0 0 0M-2-1C8-1 12 3 12 12M12 12C12 20 8 24 0 24M0 24C-8 24-11 19-12 17','M-16 10c0 0 0 0 0 0M-16 10C-16 10 6-25 6-25M6-25c0 0 0 0 0 0M6-25C6-25 6 25 6 25M-16 10c0 0 0 0 0 0M15 10c0 0 0 0 0 0M15 10C15 10-1 10-1 10M-1 10C-1 10-16 10-16 10','M-2-4C-2-4-11-4-11-4M-11-4C-11-4-11-23-11-23M-11-23C-11-23 11-23 11-23M11-23c0 0 0 0 0 0M-12 17c0 0 0 0 0 0M-2-4C8-4 12 1 12 10M12 10C12 18 8 24 0 24M0 24C-8 24-11 19-12 17','M-15 0c0 0 0 0 0 0M-15 0C-15-16-7-24 1-24M1-24C8-24 11-21 11-21M11-21c0 0 0 0 0 0M-15 0c0 0 0 0 0 0M-14 10C-13-7 14-8 14 10M14 10C14 18 8 24 0 24M0 24C-8 24-15 18-15 0','M-15-23c0 0 0 0 0 0M-15-23C-15-23 15-23 15-23M15-23c0 0 0 0 0 0M15-23C15-23 6-10 1 2M1 2C-4 14-6 25-6 25M-6 25c0 0 0 0 0 0M-6 25c0 0 0 0 0 0M-6 25c0 0 0 0 0 0','M0-2C-7-2-13-6-13-13M-13-13C-13-20-7-24 0-24M0-24C7-24 13-21 13-13M13-13C13-5 7-2 0-2M0-2C-8-2-15 3-15 11M0-2C8-2 15 2 15 11M15 11C15 20 8 24 0 24M0 24C-8 24-15 20-15 11','M14-10C13 7-14 8-14-10M-14-10C-14-18-8-24 0-24M0-24C8-24 15-18 15 0M15 0c0 0 0 0 0 0M-11 21c0 0 0 0 0 0M15 0c0 0 0 0 0 0M15 0C15 16 7 24-1 24M-1 24C-8 24-11 21-11 21']
  const anim = document.getElementsByTagName('animate')
  const input = mainPile[0].formFields[0]
  const digitInput = mainPile[1].formFields[0]
  const animateBtn = mainPile[2].formFields[0]
  let animating = false
  let lastNumber = ''
  let targetNumber = ''
  const nullDigit = 'M0 0c0 0 0 0 0 0M0 0c0 0 0 0 0 0M0 0c0 0 0 0 0 0M0 0c0 0 0 0 0 0M0 0c0 0 0 0 0 0M0 0c0 0 0 0 0 0M0 0c0 0 0 0 0 0M0 0c0 0 0 0 0 0'
  const animDuration = 1
  for (let elem of anim) {
    elem.parentNode.setAttribute('d', nullDigit)
    elem.setAttribute('dur', animDuration)
    elem.setAttribute('calcMode', 'spline')
    elem.setAttribute('keyTimes', '0;1')
    elem.setAttribute('keySplines', '0.5 0 0.5 1')
  }
  function animateDigit(anim, digit) {
    digit = Number(digit)
    anim.setAttribute('from', anim.getAttribute('to'));
    if (!isNaN(digit)) {
      anim.setAttribute('to', digits[digit]);
    } else {
      anim.setAttribute('to', nullDigit);
    }
    anim.beginElement()
  }
  function animateStr(str) {
    for(let i = 0; i < anim.length; i++)
      animateDigit(anim[i], str[i + str.length - anim.length])
    animating = true;
    lastNumber = str
    targetNumber = str
  }
  anim[anim.length-1].onend = e => {
    if (targetNumber != lastNumber)
      animateStr(targetNumber)
    else
      animating = false
  }
  input.onkeyup = function() {
    if (!animating && input.value !== lastNumber)
      animateStr(input.value);
    else
      targetNumber = input.value
  }
  digitInput.onkeyup = function() {
    let digit = event.key
    if (isNaN(Number(digit)))
      digit = digitInput.value ? digitInput.value[digitInput.value.length-1] : ''
    const str = digit.repeat(anim.length)
    digitInput.value = digit
    if (!animating && str !== lastNumber)
      animateStr(str);
    else
      targetNumber = str
  }
  let countupInterval = null
  animateBtn.startAnim = function() {
    if (countupInterval == null) {
      countupInterval = setInterval(() => {
        num = Number(lastNumber) + 1
        if (isNaN(num))
          num = 0
        animateStr(String(num))
      }, 1000)
    }
    this.innerText = 'Animating...'
    this.onclick = this.stopAnim
  }
  animateBtn.stopAnim = function() {
    clearInterval(countupInterval)
    countupInterval = null
    this.innerText = 'Animate'
    this.onclick = this.startAnim
  }
  mainPile[2].ondiscard = () => animateBtn.stopAnim()
  animateBtn.onclick = animateBtn.startAnim
</script>
</body>
</html>
